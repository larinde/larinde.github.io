# Data Historisation Solution

## Challenge

1. Process execution in microservice architectures are inherently distributed and span multiple independent services.
2. Data points captured in the end-to-end execution of a process vary, depending on context and ownership of interacting services.
3. Unique process identifiers may vary across multiple services.

## Solution

- Definition of a standard data format and structure for capturing historisation data.
- Governance on implementation of historisation data collection.
- Centralised data storage that enables simplified querying and aggregation of historisation data

## Solution Technology

- Elasticsearch, Fluentd and Kibana (EFK) stack
   1. Fluentd
      - A data collector with integration support for various data sources
   2. Elasticsearch
      - A fast and highly scalable storage and search engine
      - Provides a RESTful interface for building aggregated response data
   3. Kibana
      - An optional data visualisation tool and dashboard for Elasticsearch
      - Provides power users the ability to build and visualise complex data queries  
- ArchUnit for enforcing rules around implementation of data collection and automating compliance checks in a delivery pipeline

## Draft Data Structure  

| Data Elements   | Description                                                                                                 |
|:----------------|:-----------------------------------------------------------------------------------------------------------|
| ServiceName     | A unique application name                                                                                   |
| Version         | API version or Source code version (git-commit-id-plugin)                                                   |
| Location        | Geolocation - possibly at the point of capture - eg at dealership, where an order initiation was triggered  |
| Timestamp       |                                                                                                             |
| EventName       | A name that captures the domain and business context eg OFFER_ACCEPTED, ORDER_FULFILLMENT_INITIATED         |
| Description     | A summary of the context                                                                                    |
| EventId         | A unique business context ID - defined in business logic. example - OfferId, OrderId, StockId, deliveryId, etc |
| TraceId         | A unique technical correlation ID - trace ID generated by a distributed tracing tool eg AWS X-Ray, Zipkin, etc                           |
|ContextData - a key-value pair data structure for capturing additional information      ||
| <service_identifier>_<data_context> | example - SCP_SALES_CHANNEL = Daily Rental    |


## End-to-End Data Historisation Flow

![Historisation Flow](./images/prj_daimler_data_historisation_flow.png)

